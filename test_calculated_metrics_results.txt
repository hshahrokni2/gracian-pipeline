
======================================================================
WEEK 2 DAY 1-2: CALCULATED FINANCIAL METRICS TEST SUITE
======================================================================

======================================================================
TEST 1: Dynamic Tolerance Thresholds
======================================================================

Small amount (<100k):
  Amount: 50,000 SEK
  Tolerance: Â±7,500 SEK (15.0%)

Medium amount (100k-10M):
  Amount: 500,000 SEK
  Tolerance: Â±50,000 SEK (10.0%)

Large amount (>10M):
  Amount: 50,000,000 SEK
  Tolerance: Â±2,500,000 SEK (5.0%)

âœ… TEST 1 PASSED: Dynamic tolerance working correctly

======================================================================
TEST 2: Debt per sqm - VALID Status (Within Tolerance)
======================================================================

Extracted debt: 99,538,124 SEK
Extracted area: 5,000 mÂ²
Extracted debt/mÂ²: 19,900 SEK/mÂ²
Calculated debt/mÂ²: 19,908 SEK/mÂ²

Validation Status: valid
Overall Status: valid
Overall Confidence: 0.95

âœ… TEST 2 PASSED: VALID status working correctly

======================================================================
TEST 3: Solidarity Percent - WARNING Status (Within 2x Tolerance)
======================================================================

Extracted equity: 201,801,694 SEK
Extracted assets: 301,339,818 SEK
Extracted solidarity: 70.0%
Calculated solidarity: 67.0%

Validation Status: warning
Overall Status: warning
Overall Confidence: 0.70
Warnings: ['solidarity_percent: extracted=70.0%, calculated=67.0%, diff=3.0 pp (tolerance=2.0 pp, 2x=4.0 pp)']

âœ… TEST 3 PASSED: WARNING status working correctly (data preserved)

======================================================================
TEST 4: Fee per sqm - ERROR Status (Beyond 2x Tolerance)
======================================================================

Extracted monthly fee: 10,000 SEK
Extracted area: 100 mÂ²
Extracted fee/mÂ²/Ã¥r: 15,000 SEK/mÂ²/Ã¥r
Calculated fee/mÂ²/Ã¥r: 1,200 SEK/mÂ²/Ã¥r

Validation Status: error
Overall Status: error
Overall Confidence: 0.40
Errors: ['fee_per_sqm_annual: Large discrepancy - extracted=15000, calculated=1200, diff=13800 SEK/mÂ²/Ã¥r (>2x tolerance)']

âœ… TEST 4 PASSED: ERROR status working correctly (data preserved)

======================================================================
TEST 5: Calculated-Only Metrics (No Extracted Value)
======================================================================

Extracted debt: 100,000,000 SEK
Extracted area: 5,000 mÂ²
Calculated debt/mÂ²: 20,000 SEK/mÂ²

Validation Status: calculated_only
Overall Status: calculated_only
Overall Confidence: 0.85

âœ… TEST 5 PASSED: Calculated-only metrics working correctly

======================================================================
TEST 6: No Data Scenario
======================================================================

Validation Status: no_data
Overall Confidence: 0.00

âœ… TEST 6 PASSED: No data scenario handled correctly

======================================================================
TEST 7: Integration with FinancialData Model
======================================================================

FinancialData created successfully
Calculated metrics status: valid
Calculated metrics confidence: 0.95

âœ… TEST 7 PASSED: Integration with FinancialData working correctly

======================================================================
TEST SUMMARY
======================================================================
âœ… test_dynamic_tolerance: PASSED
âœ… test_debt_per_sqm_valid: PASSED
âœ… test_solidarity_percent_warning: PASSED
âœ… test_fee_per_sqm_error: PASSED
âœ… test_calculated_only: PASSED
âœ… test_no_data: PASSED
âœ… test_integration_with_financial_data: PASSED

======================================================================
TOTAL: 7/7 tests passed (100.0%)
======================================================================

ðŸŽ‰ ALL TESTS PASSED! Week 2 Day 1-2 COMPLETE!
