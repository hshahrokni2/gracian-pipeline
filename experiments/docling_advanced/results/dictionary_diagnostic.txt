2025-10-11 16:52:08,948 - INFO - detected formats: [<InputFormat.PDF: 'pdf'>]
2025-10-11 16:52:08,978 - INFO - Going to convert document batch...
2025-10-11 16:52:08,978 - INFO - Initializing pipeline for StandardPdfPipeline with options hash 89360827c54c632ffd3869eb23c81de0
2025-10-11 16:52:08,982 - INFO - Loading plugin 'docling_defaults'
2025-10-11 16:52:08,983 - INFO - Registered picture descriptions: ['vlm', 'api']
2025-10-11 16:52:08,986 - INFO - Loading plugin 'docling_defaults'
2025-10-11 16:52:08,988 - INFO - Registered ocr engines: ['easyocr', 'ocrmac', 'rapidocr', 'tesserocr', 'tesseract']
2025-10-11 16:52:09,102 - INFO - Accelerator device: 'mps'
2025-10-11 16:52:11,449 - INFO - Accelerator device: 'mps'
2025-10-11 16:52:12,399 - INFO - Accelerator device: 'mps'
2025-10-11 16:52:12,683 - INFO - Processing document brf_268882.pdf
2025-10-11 16:53:44,867 - INFO - Finished converting document brf_268882.pdf in 95.92 sec.
================================================================================
DICTIONARY MATCHING DIAGNOSTIC
================================================================================

üîç Extracting sections from Docling...
   Found 50 sections

================================================================================
STEP 1: RAW SECTION HEADINGS FROM DOCLING
================================================================================

Total sections: 50

First 10 section headings:
 1. Page  1 | Level 1 | V√§lkommen till √•rsredovisningen f√∂r Brf Hagelb√∂ssan 1 1 Hjorthagen
 2. Page  2 | Level 1 | Kort till l√§sning av √•rsredovisningen guide
 3. Page  2 | Level 1 | F√∂rvaltningsber√§ttelse
 4. Page  2 | Level 1 | Resultatr√§kning
 5. Page  2 | Level 1 | Balansr√§kning
 6. Page  2 | Level 1 | Kassafl√∂desanalys
 7. Page  2 | Level 1 | Noter
 8. Page  2 | Level 1 | Giltighet
 9. Page  3 | Level 1 | F√∂rvaltningsber√§ttelse
10. Page  3 | Level 1 | Verksamheten

================================================================================
STEP 2: ROUTING CONFIGURATIONS LOADED
================================================================================

Main section keywords: 4 agent types
   ‚Ä¢ governance_agent: 8 keywords
   ‚Ä¢ financial_agent: 8 keywords
   ‚Ä¢ property_agent: 9 keywords
   ‚Ä¢ operations_agent: 6 keywords

Dictionary patterns: 5 categories
   ‚Ä¢ balance_sheet: 3 patterns
   ‚Ä¢ income_statement: 3 patterns
   ‚Ä¢ notes: 4 patterns
   ‚Ä¢ governance: 3 patterns
   ‚Ä¢ audit: 3 patterns

================================================================================
STEP 3: MULTI-LAYER MATCHING ANALYSIS
================================================================================

üìä MATCHING STATISTICS:

   Total sections: 50
   Matched sections: 25 (50%)
   Unmatched sections: 25

   Layer Performance:
      Layer 1 (substring): 21 matches
      Layer 2 (preprocessed): 0 matches
      Layer 3 (fuzzy): 12 matches

================================================================================
STEP 4: SAMPLE MATCHES
================================================================================

‚úÖ 'F√∂rvaltningsber√§ttelse'
   ‚Üí substring match
   ‚Üí Agent/Category: governance_agent
   ‚Üí Score: 1.00

‚úÖ 'Resultatr√§kning'
   ‚Üí substring match
   ‚Üí Agent/Category: financial_agent
   ‚Üí Score: 1.00

‚úÖ 'Balansr√§kning'
   ‚Üí substring match
   ‚Üí Agent/Category: financial_agent
   ‚Üí Score: 1.00

‚úÖ 'Kassafl√∂desanalys'
   ‚Üí substring match
   ‚Üí Agent/Category: financial_agent
   ‚Üí Score: 1.00

‚úÖ 'Noter'
   ‚Üí fuzzy match
   ‚Üí Agent/Category: notes
   ‚Üí Score: 1.00

‚úÖ 'Giltighet'
   ‚Üí substring match
   ‚Üí Agent/Category: governance_agent
   ‚Üí Score: 1.00

‚úÖ 'F√∂rvaltningsber√§ttelse'
   ‚Üí substring match
   ‚Üí Agent/Category: governance_agent
   ‚Üí Score: 1.00

‚úÖ 'Verksamheten'
   ‚Üí substring match
   ‚Üí Agent/Category: operations_agent
   ‚Üí Score: 0.83

‚úÖ 'Allm√§nt om verksamheten'
   ‚Üí substring match
   ‚Üí Agent/Category: operations_agent
   ‚Üí Score: 0.43

‚úÖ 'Fastigheten'
   ‚Üí substring match
   ‚Üí Agent/Category: property_agent
   ‚Üí Score: 0.82

================================================================================
STEP 5: SAMPLE MISMATCHES (First 10)
================================================================================

‚ùå Page  1 | V√§lkommen till √•rsredovisningen f√∂r Brf Hagelb√∂ssan 1 1 Hjorthagen
   Preprocessed (final): 'valkommen till arsredovisningen for brf hagelbossan 1 1 hjor'

‚ùå Page  2 | Kort till l√§sning av √•rsredovisningen guide
   Preprocessed (final): 'kort till lasning av arsredovisningen guide'

‚ùå Page  3 | Registreringsdatum
   Preprocessed (final): 'registreringsdatum'

‚ùå Page  3 | √Ñkta f√∂rening
   Preprocessed (final): 'akta forening'

‚ùå Page  5 | Medlemsinformation
   Preprocessed (final): 'medlemsinformation'

‚ùå Page  6 | Fler√•rs√∂versikt
   Preprocessed (final): 'flerarsoversikt'

‚ùå Page  7 | Upplysning vid f√∂rlust
   Preprocessed (final): 'upplysning vid forlust'

‚ùå Page  7 | F√∂r√§ndringar i eget kapital
   Preprocessed (final): 'forandringar i eget kapital'

‚ùå Page  7 | Resultatdisposition
   Preprocessed (final): 'resultatdisposition'

‚ùå Page 12 | NOT 1 REDOVISNINGS- OCH V√ÑRDERINGSPRINCIPER
   Preprocessed (final): '1 redovisnings- och varderingsprinciper'

================================================================================
STEP 6: PATTERN ANALYSIS
================================================================================

Patterns identified:
   ‚Ä¢ Uppercase: 2/50 (4%)
      ‚Üí Sections in ALL CAPS
      ‚Üí Fix: Preprocessing normalizes case

   ‚Ä¢ Swedish Characters: 31/50 (62%)
      ‚Üí Sections contain Swedish characters (√•, √§, √∂)
      ‚Üí Fix: Preprocessing normalizes to ASCII

================================================================================
STEP 7: RECOMMENDATIONS
================================================================================

1. ‚úÖ Fuzzy matching catching edge cases - keep Layer 3
2. üîÑ Add LLM classification fallback (Layer 4) for remaining sections
3.    ‚Üí ~$0.03 cost for LLM classification

================================================================================
DIAGNOSTIC COMPLETE
================================================================================

üìÅ Detailed results saved to:
   ‚Ä¢ results/dictionary_diagnostic.json
   ‚Ä¢ results/dictionary_diagnostic.txt
